<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">

<title>health_success.feature - RDoc Documentation</title>

<link href="../fonts.css" rel="stylesheet">
<link href="../rdoc.css" rel="stylesheet">

<script type="text/javascript">
  var rdoc_rel_prefix = "../";
</script>

<script src="../js/jquery.js"></script>
<script src="../js/navigation.js"></script>
<script src="../js/search_index.js"></script>
<script src="../js/search.js"></script>
<script src="../js/searcher.js"></script>
<script src="../js/darkfish.js"></script>


<body id="top" role="document" class="file">
<nav role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="../index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="../table_of_contents.html#pages">Pages</a>
    <a href="../table_of_contents.html#classes">Classes</a>
    <a href="../table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search" spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  

  <div id="project-metadata">
    <div id="fileindex-section" class="nav-section">
  <h3>Pages</h3>

  <ul class="link-list">
  
    <li><a href="../Gemfile.html">Gemfile</a>
  
    <li><a href="../Gemfile_lock.html">Gemfile.lock</a>
  
    <li><a href="../Guardfile.html">Guardfile</a>
  
    <li><a href="../LICENSE_txt.html">LICENSE</a>
  
    <li><a href="../README_md.html">README</a>
  
    <li><a href="../README_rdoc.html">README</a>
  
    <li><a href="../Rakefile.html">Rakefile</a>
  
    <li><a href="../elevage_gemspec.html">elevage.gemspec</a>
  
    <li><a href="../features/archive.html">archive</a>
  
    <li><a href="../features/elevage_feature.html">elevage.feature</a>
  
    <li><a href="../features/health_failure_feature.html">health_failure.feature</a>
  
    <li><a href="../features/health_success_feature.html">health_success.feature</a>
  
    <li><a href="../features/list_feature.html">list.feature</a>
  
    <li><a href="../features/new_feature.html">new.feature</a>
  
    <li><a href="../features/step_definitions/temp.html">temp</a>
  
    <li><a href="../html/Elevage_html.html">Elevage.html</a>
  
    <li><a href="../html/Elevage/CLI_html.html">CLI.html</a>
  
    <li><a href="../html/Elevage/Generate_html.html">Generate.html</a>
  
    <li><a href="../html/Elevage/New_html.html">New.html</a>
  
    <li><a href="../html/Elevage/Platform_html.html">Platform.html</a>
  
    <li><a href="../html/Elevage/Runner_html.html">Runner.html</a>
  
    <li><a href="../html/README_rdoc_html.html">README_rdoc.html</a>
  
    <li><a href="../html/fonts_css.html">fonts.css</a>
  
    <li><a href="../html/index_html.html">index.html</a>
  
    <li><a href="../html/js/darkfish_js.html">darkfish.js</a>
  
    <li><a href="../html/js/jquery_js.html">jquery.js</a>
  
    <li><a href="../html/js/navigation_js.html">navigation.js</a>
  
    <li><a href="../html/js/search_js.html">search.js</a>
  
    <li><a href="../html/js/search_index_js.html">search_index.js</a>
  
    <li><a href="../html/js/searcher_js.html">searcher.js</a>
  
    <li><a href="../html/rdoc_css.html">rdoc.css</a>
  
    <li><a href="../html/table_of_contents_html.html">table_of_contents.html</a>
  
    <li><a href="../lib/elevage/templates/compute_yml_tt.html">compute.yml.tt</a>
  
    <li><a href="../lib/elevage/templates/network_yml_tt.html">network.yml.tt</a>
  
    <li><a href="../lib/elevage/templates/platform_yml_tt.html">platform.yml.tt</a>
  
    <li><a href="../lib/elevage/templates/vcenter_yml_tt.html">vcenter.yml.tt</a>
  
    <li><a href="../results_html.html">results.html</a>
  
  </ul>
</div>

  </div>
</nav>

<main role="main" aria-label="Page features/health_success.feature">

<p>Feature: HEALTH check of platform definition file items</p>

<pre>As an Infracoder developing a command line tool
I want to be able to diagnose the syntactical health of the standard platform definition and environment definition yml files
In order to maintain the health of the elevage platform definition files

Scenario: check health of standard desired state items

  Given a file named &quot;platform.yml&quot; with:
  &quot;&quot;&quot;
  platform:
    name: default_app
    description: &#39;description of the default_app&#39;

    environments:
      - int
      - prod

    tiers:
      - Web
      - App

    nodenameconvention:
      - environment
      - &#39;-&#39;
      - component
      - &#39;-&#39;
      - instance
      - geo

    pools:
      webvmdefaults: &amp;webvmdefaults
        count: 2
        tier: Web
        image: &#39;centos-6.5-x86_64-20140714&#39;
        compute: nonprodweb
        port: 0

      appvmdefaults: &amp;appvmdefaults
        &lt;&lt;: *webvmdefaults
        tier: App
        compute: nonprodapp

    components:
      api:
        &lt;&lt;: *webvmdefaults
        port: 8080

      cui:
        &lt;&lt;: *webvmdefaults
        port: 8082

      terracotta:
        &lt;&lt;: *webvmdefaults
        compute: nonprodtc
        image: &#39;centos32g-6.5-x86_64-20140714&#39;

      email:
        &lt;&lt;: *appvmdefaults
        port: 8130

      mq:
        &lt;&lt;: *appvmdefaults
        port: 1234
        compute: nonprodmq
        image: &#39;centos32g-6.5-x86_64-20140714&#39;
  &quot;&quot;&quot;
  Given a file named &quot;infrastructure/vcenter.yml&quot; with:
  &quot;&quot;&quot;
  vcenter:
    name: default_app

    locations:
      nonprod: &amp;vcenter
        geo: west
        timezone: 085

        host: &#39;vcwest.corp.local&#39;
        datacenter: &#39;WCDC NonProd&#39;
        imagefolder: &#39;Corporate/Platform Services/Templates&#39;
        destfolder: &#39;Corporate/Platform Services/default_app&#39;
        resourcepool: &#39;App-Web Linux/Corporate&#39;
        appendenv: true
        appenddomain: true
        datastores:
          - NonProd_Cor_25
          - NonProd_Cor_26
          - NonProd_Cor_38
          - NonProd_Cor_39

        domain: dev.corp.local
        dnsips:
          - 10.10.10.5
          - 10.10.10.6

      prod:
        &lt;&lt;: *vcenter

        datacenter: &#39;WCDC Prod&#39;
        datastores:
          - Prod_Cor_03
          - Prod_Cor_04

        domain: corp.local
        dnsips:
          - 10.20.100.5
          - 10.20.100.6
  &quot;&quot;&quot;
  Given a file named &quot;infrastructure/network.yml&quot; with:
  &quot;&quot;&quot;
  network:
    name: default_app

    devweb:
      vlanid: DEV_WEB_NET
      gateway: &#39;10.10.128.1&#39;
      netmask: 19

    devapp:
      vlanid: DEV_APP_NET
      gateway: &#39;10.10.160.1&#39;
      netmask: 20

    prodweb:
      vlanid: PRD_WEB_NET
      gateway: &#39;10.119.128.1&#39;
      netmask: 19

    prodapp:
      vlanid: PRD_APP_NET
      gateway: &#39;10.119.160.1&#39;
      netmask: 20
  &quot;&quot;&quot;
  Given a file named &quot;infrastructure/compute.yml&quot; with:
  &quot;&quot;&quot;
  compute:
    name: default_app

    options:
      default: &amp;default
        cpu: 2
        ram: 2

      nonprodweb:
        &lt;&lt;: *default

      nonprodapp:
        &lt;&lt;: *default
        ram: 6

      nonprodtc:
        &lt;&lt;: *default
        ram: 8

      nonprodmq:
        &lt;&lt;: *default
        ram: 12

      prodweb:
        &lt;&lt;: *default
        ram: 6

      prodapp:
        &lt;&lt;: *default
        ram: 6

      prodtc:
        &lt;&lt;: *default
        ram: 32

      prodmq:
        &lt;&lt;: *default
        cpu: 8
        ram: 32
  &quot;&quot;&quot;
  Given a file named &quot;environments/int.yml&quot; with:
  &quot;&quot;&quot;
  environment:
    vcenter: nonprod

    pool:
      webvmdefaults: &amp;webvmdefaults
          network: devweb
          compute: nonprodweb

      appvmdefaults: &amp;appvmdefaults
        &lt;&lt;: *webvmdefaults
        network: devapp
        compute: nonprodapp

    components:
      api:
          addresses:
              - 10.10.137.42
              - 10.10.137.43

      cui:
          addresses:
              - 10.10.137.64
              - 10.10.137.65

      terracotta:
          addresses:
              - 10.10.137.95
              - 10.10.137.96

      email:
          addresses:
              - 10.10.161.53
              - 10.10.161.54

      mq:
          addresses:
              - 10.10.161.77
              - 10.10.161.78
  &quot;&quot;&quot;
  Given a file named &quot;environments/prod.yml&quot; with:
  &quot;&quot;&quot;
  environment:
    vcenter: prod

    pool:
      webvmdefaults: &amp;webvmdefaults
          network: prodweb
          count: 4
          compute: prodweb

      appvmdefaults: &amp;appvmdefaults
        &lt;&lt;: *webvmdefaults
        network: prodapp
        compute: prodapp

    components:
      api:
          addresses:
              - 10.119.137.72
              - 10.119.137.73
              - 10.119.137.74
              - 10.119.137.75

      cui:
          addresses:
              - 10.119.137.133
              - 10.119.137.134
              - 10.119.137.135
              - 10.119.137.136

      terracotta:
          count: 2
          compute: prodtc
          addresses:
              - 10.119.137.218
              - 10.119.137.219
          port: 0000

      email:
          addresses:
              - 10.119.161.137
              - 10.119.161.138
              - 10.119.161.139
              - 10.119.161.140

      mq:
          count: 2
          compute: prodmq
          addresses:
              - 10.119.161.206
              - 10.119.161.207
  &quot;&quot;&quot;

  When I run `elevage health`
  Then the exit status should be 0
  And the result should contain &quot;All platform desired state files present and consistently configured&quot;</pre>
</main>



<footer id="validator-badges" role="contentinfo">
  <p><a href="http://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="http://rdoc.rubyforge.org">RDoc</a> 4.1.1.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

